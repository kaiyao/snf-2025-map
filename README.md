# Singapore Night Festival 2025

This repo contains a set of scripts that can be used to generate a KML file that can be imported into Google My Maps

## Prerequsites
Install the required packages using pip. Would suggest using a virtualenv for this project. Then,
`pip install -r requirements.txt`

## Running the scripts
To generate the KML, I have split the process into a few steps/scripts.
Each script is meant to be run one after the other, in order.

`1_fetch_event_items.py`: this script fetches the data from the heritage.sg website and writes the data into JSON files in the format `data-2025-XX-XX.json`

`2_combine_event_items.py`: this script combines the various events from each day's JSON files into one combined `data-combined.json` (so if an event occurs on more than 1 day, it is only recorded once, but each day is recorded in the `ProcessedEventDates` attribute)

`3_augment_event_items.py`: this script takes the `data-combined.json` file and generates a `data-augmented.json` file. This script mainly does some manual fixes/customizations to the data from the website, including:
  - Some events have multiple sub-events listed in the description. We split them into separate events
  - Events that have more than one venue listed in the same event will need to have it split up so that we can generate two markers for the same event later
  - We add the event number from the guide into the JSON data. The event numbers come from `data-event-numbers.csv` (which was initially generated by asking ChatGPT to analyse the PDF guide, and then any mistakes/mismatches manually fixed)

`4_generate_kml.py`: this script takes the `data-augmented.json` and generates a `result.kml` file. It does quite a lot of things:
  - Sort the items by the event number and title
  - Group each event into it's own folder in the KML (by the category). This is because Google My Maps allows users to show/hide individual folders. Thus this allows users to control what categories of events they would like to see.
  - Some events have more than one venue or category. Thus, for each venue and category, we create a placemark in the KML file.
  - We generate a "description" based on the data. We would also use "ExtendedData" attributes in the KML but My Maps would display that as a table which is less pretty.
  - Note that each placemark uses a custom icon that references a URL. The icons are generated with the next script

`5_generate_icons.py`: this script generates the individual numbered icons using the templates for each category found in the icons/template folder. These templates were copied from the PDF guide using Inkscape, and then exported as PNGs. You also need the Prodigy Sans font from this repo: https://github.com/weiweihuanghuang/Prodigy-Sans (copy the fonts folder to this folder). After generating you will need to upload the icons to a server that you can reference in the KML (in step 4).

## Notes
In step 4, the script references a "Reference KML file". This is the file where the coordinates of each event is fetched from.

The data on the heritage.sg website only has coordinates for selected locations. Thus an earlier version of this script generated a CSV file with each event name and the address/lat/lng which can be imported into My Maps, which will then do an address lookup for each event without coordinates.

The "Reference KML file" is then the KML file exported from My Maps. Unfortunately, My Maps doesn't export the looked-up coordinates unless you manually move each marker a bit. Either way, I manually moved each marker to be nearer to the actual event location rather than just the building's location.
